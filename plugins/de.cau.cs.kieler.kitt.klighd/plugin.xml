<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension point="org.eclipse.emf.edit.itemProviderAdapterFactories">
      <factory
            uri="http://kieler.cs.cau.de/tracingtree/0.1.0"
            class="de.cau.cs.kieler.kitt.klighd.editor.TracingTreeItemProviderAdapterFactory"
            supportedTypes=
              "org.eclipse.emf.edit.provider.IEditingDomainItemProvider
               org.eclipse.emf.edit.provider.IStructuredItemContentProvider
               org.eclipse.emf.edit.provider.ITreeItemContentProvider
               org.eclipse.emf.edit.provider.IItemLabelProvider
               org.eclipse.emf.edit.provider.IItemPropertySource"/>
   </extension>   
   <extension point="org.eclipse.ui.editors">
      <editor
            id="de.cau.cs.kieler.kitt.klighd.editor.TracingTreeEditorID"
            name="%_UI_TracingTreeEditor_label"
            icon="icons/full/TracingTreeModelFile.gif"
            extensions="kitt"
            class="de.cau.cs.kieler.kitt.klighd.editor.TracingTreeEditor"
            contributorClass="de.cau.cs.kieler.kitt.klighd.editor.TracingTreeActionBarContributor">
      </editor>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="de.cau.cs.kieler.kitt.klighd.enable.select.source">
         <and>
            <with
                  variable="activeMenuSelection">
               <count
                     value="1">
               </count>
            </with>
            <reference
                  definitionId="de.cau.cs.kieler.klighd.ui.nodesSelected">
            </reference>
            <test
                  property="de.cau.cs.kieler.kitt.klighd.enable.select.property.source">
            </test>
         </and>
      </definition>
      <definition
            id="de.cau.cs.kieler.kitt.klighd.enable.select.target">
         <and>
            <with
                  variable="activeMenuSelection">
               <count
                     value="1">
               </count>
            </with>
            <reference
                  definitionId="de.cau.cs.kieler.klighd.ui.nodesSelected">
            </reference>
            <test
                  property="de.cau.cs.kieler.kitt.klighd.enable.select.property.target">
            </test>
         </and>
      </definition>
      <definition
            id="de.cau.cs.kieler.kitt.klighd.enable.select.none">
         <and>
            <reference
                  definitionId="de.cau.cs.kieler.klighd.ui.isKlighdContext">
            </reference>
            <test
                  property="de.cau.cs.kieler.kitt.klighd.enable.select.property.none">
            </test>
         </and>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="popup:org.eclipse.ui.popup.any?before=additions">
         <menu
               id="de.cau.cs.kieler.klighd.ui.menu.group"
               label="Tracing">
            <command
                   commandId="de.cau.cs.kieler.klighd.ui.actionExecution"
                   id="de.cau.cs.kieler.kitt.klighd.menu.select.source"
                   label="Select as source model"
                   style="push"
                   tooltip="Select the underlying model element as source model of a direct tracing.">
                <parameter
                      name="de.cau.cs.kieler.klighd.ui.action"
                      value="de.cau.cs.kieler.kitt.klighd.action.select.source">
                </parameter>
                <visibleWhen
                      checkEnabled="false">
                   <reference
                         definitionId="de.cau.cs.kieler.kitt.klighd.enable.select.source">
                   </reference>
                </visibleWhen>
             </command>
             <command
                   commandId="de.cau.cs.kieler.klighd.ui.actionExecution"
                   id="de.cau.cs.kieler.kitt.klighd.menu.select.target"
                   label="Select as target model"
                   style="push"
                   tooltip="Select the underlying model element as target model of a direct tracing.">
                <parameter
                      name="de.cau.cs.kieler.klighd.ui.action"
                      value="de.cau.cs.kieler.kitt.klighd.action.select.target">
                </parameter>
                <visibleWhen
                      checkEnabled="false">
                   <reference
                         definitionId="de.cau.cs.kieler.kitt.klighd.enable.select.target">
                   </reference>
                </visibleWhen>
             </command>
             <command
                   commandId="de.cau.cs.kieler.klighd.ui.actionExecution"
                   id="de.cau.cs.kieler.kitt.klighd.menu.select.none"
                   label="Remove selection"
                   style="push"
                   tooltip="Deselect both source and traget model of the direct tracing.">
                <parameter
                      name="de.cau.cs.kieler.klighd.ui.action"
                      value="de.cau.cs.kieler.kitt.klighd.action.select.none">
                </parameter>
                <visibleWhen
                      checkEnabled="false">
                   <reference
                         definitionId="de.cau.cs.kieler.kitt.klighd.enable.select.none">
                   </reference>
                </visibleWhen>
             </command>
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
         </menu>
      </menuContribution>
   </extension>
   <extension
         point="de.cau.cs.kieler.klighd.diagramSyntheses">
   <diagramSynthesis
         class="de.cau.cs.kieler.klighd.syntheses.GuiceBasedSynthesisFactory:de.cau.cs.kieler.kitt.klighd.synthesis.TracingTreeDiagramSynthesis"
         id="de.cau.cs.kieler.kitt.klighd.syntheses.TracingTreeDiagramSynthesis">
   </diagramSynthesis>
   </extension>
   <extension
         point="de.cau.cs.kieler.klighd.extensions">
      <updateStrategy
            class="de.cau.cs.kieler.kitt.klighd.update.TracingVisualizationUpdateStrategy"
            id="de.cau.cs.kieler.kitt.klighd.update.TracingVisualizationUpdateStrategy">
      </updateStrategy>
      <action
            class="de.cau.cs.kieler.kitt.klighd.actions.DeselectTracingSelectionAction"
            id="de.cau.cs.kieler.kitt.klighd.action.select.none">
      </action>
      <action
            class="de.cau.cs.kieler.kitt.klighd.actions.SourceTracingSelectionAction"
            id="de.cau.cs.kieler.kitt.klighd.action.select.source">
      </action>
      <action
            class="de.cau.cs.kieler.kitt.klighd.actions.TargetTracingSelectionAction"
            id="de.cau.cs.kieler.kitt.klighd.action.select.target">
      </action>
      <action
            class="de.cau.cs.kieler.kitt.klighd.actions.MemorizedCollapseExpandAction"
            id="de.cau.cs.kieler.kitt.klighd.actions.MemorizedCollapseExpandAction">
      </action>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="de.cau.cs.kieler.kitt.klighd.actions.TracingSelectionEnablePropertyTester"
            id="de.cau.cs.kieler.kitt.klighd.enable.select.property.tester"
            namespace="de.cau.cs.kieler.kitt.klighd.enable.select.property"
            properties="source,target,none"
            type="java.lang.Object">
      </propertyTester>
   </extension>
</plugin>
